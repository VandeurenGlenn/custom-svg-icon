<script>
  class SvgIcon extends HTMLElement {
    /**
     * Attributes to observer
     * @return {Array} ['icon']
     */
    static get observedAttributes() {
      return ['icon'];
    }
    /**
     * Create icon-button
     * @param {object} opts Default options
     * @param {number} opts.width The desired height for the svg.
     * @param {number} opts.height The desired width for the svg.
     * @param {string} opts.color The color to fill.
     * @param {string} opts.stroke The stroke color.
     */
    constructor(opts={width: 40, height: 40, color: '#FFF', stroke: 'none'}) {
      super();
      this.root = this.attachShadow({mode: 'open'});
      this.root.innerHTML = `
      <style>
        :host {
          width: ${opts.width}px;
          height: ${opts.height}px;
          fill: var(--svg-icon-color, ${opts.color});
          stroke: var(--svg-icon-stroke, ${opts.stroke});
        }
      </style>`;
    }
    /**
     * Iconset
     * @return {object} window.svgIconset
     * [checkout](svg-iconset.html) for more info.
     */
    get iconset() {
      return window.svgIconset;
    }
    /**
     * icon
     * @param {string} value The desired icon.
     * optional: you can create multiple iconsets
     * by setting a different name on svg-iconset.
     *
     * **example:** ```html
     * <svg-iconset name="my-icons">
     *   <g id="menu">....</g>
     * </svg-iconset>
     * ```
     * This means we can ask for the icon using a prefix
     * **example:** ```html
     * <reef-icon-button icon="my-icons::menu"></reef-icon-button>
     * ```
     */
    set icon(value) {
      if (value) {
        let parts = value.split('::');
        if (parts.length === 1) {
          this.iconset['icons'].host.applyIcon(this, value);
        } else {
          this.iconset[parts[0]].host.applyIcon(this, parts[1]);
        }
      } else {
        let parts = this._icon.split('::');
        if (parts.length === 1) {
          this.iconset['icons'].host.removeIcon(this);
        } else {
          this.iconset[parts[0]].host.removeIcon(this);
        }
      }
      this._icon = value;
    }
    /**
     * Runs when attribute changes.
     * @param {string} name The name of the attribute that changed.
     * @param {string|object|array} oldValue
     * @param {string|object|array} newValue
     */
    attributeChangedCallback(name, oldValue, newValue) {
      if (oldValue !== newValue) this[name] = newValue;
    }
  }
  customElements.define('svg-icon', SvgIcon);
</script>
